#!/bin/bash

#=======================================================================
# wi
# File ID: afcf3af0-27a5-11e1-b643-4b2592583869
# [Description]
# License: GNU General Public License version 2 or later.
#=======================================================================

progname=wi

search_str=
stdin=

if test -z "$1"; then
    stdin="`finduuid -u`"
fi

unset or_str
for f in "$@" $stdin; do
    search_str="$search_str ${or_str}s::varchar ILIKE '%$f%'"
    or_str="OR "
done

test -z "$search_str" && {
    echo $progname: No search strings found >&2
    exit 1
}

cat <<END | psql suuids | sort -u | less
COPY (SELECT s FROM uuids WHERE$search_str) TO STDOUT;
END
